<% provide(:title, 'Postings') %>

<h1>Postings</h1>

<% if @postings != nil && @postings.any? %>
  <table class="table">
    <thead>
      <tr>
        <th>Producer</th>
        <th>Product</th>
        <th>Description</th>
        <th>Price</th>   
        <th>Unit</th>
        <th>Posting</th>
        <% if current_user.account_type == User.types[:ADMIN] %>
          <th>Do delivery</th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @postings.each do |posting| %>
        <tr>
          <td><%= User.find_by(id: posting.user_id).farm_name %></td>
          <td><%= Product.find_by(id: posting.product_id).name %></td>
          <td>TODO: display via javascript</td>
          <td><%= posting.price %></td>
          <td><%= UnitKind.find_by(id: posting.unit_kind_id).name %></td>
          <td><%= link_to "view", new_tote_item_path(posting_id: posting.id) %></td>
          <% if current_user.account_type == User.types[:ADMIN] %>
            <th><%= link_to "Go!", tote_items_next_path( tote_item: {posting_id: posting.id}) %></th>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<% if false %>
<th><%= link_to "Go!", 'tote_items/next', posting_id: posting.id %></th>
<% end %>